<!DOCTYPE html>
<html>
    <head>
        <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
        <base href="$FLUTTER_BASE_HREF">
        <meta charset="UTF-8" />
        <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
        <meta name="description" content="Similoluwa Ogunleye's Portfolio" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- iOS meta tags & icons -->
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <meta name="apple-mobile-web-app-title" content="Similoluwa Ogunleye" />
        <!-- <link rel="apple-touch-icon" href="icons/Icon-192.png" /> -->

        <!-- Favicon -->
        <!-- <link rel="icon" type="image/png" href="favicon.png" /> -->

        <title>Similoluwa Ogunleye</title>
        <link rel="manifest" href="manifest.json" />

        <script>
            // The value below is injected by Flutter build, do not touch.
            var serviceWorkerVersion = '{{flutter_service_worker_version}}';
        </script>
        <!-- This script adds the flutter initialization JS code -->
        <script src="flutter.js" defer></script>
        <style>
            .loading {
                display: flex;
                justify-content: center;
                align-items: center;
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .loader {
                border: 3px solid #f3f3f3;
                border-radius: 50%;
                border-top: 3px solid #3498db;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>
        <meta name="referrer" content="no-referrer">
    </head>

    <body style="overflow: hidden">
        <div id="loading" class="loading">
            <div class="loader"></div>
        </div>
        <script>
            window.addEventListener('load', function() {
                // Initialize service worker first
                var serviceWorkerActivated = false;
                if ('serviceWorker' in navigator) {
                    window.addEventListener('flutter-first-frame', function() {
                        navigator.serviceWorker.register('flutter_service_worker.js?v=' + serviceWorkerVersion);
                    });
                }
                
                // Load Flutter app with timeout
                var timeoutId = setTimeout(function() {
                    var loadingElement = document.querySelector('#loading');
                    if (loadingElement) {
                        loadingElement.innerHTML = 'Failed to load. Please refresh the page.';
                    }
                }, 10000); // 10 second timeout

                _flutter.loader.load({
                    serviceWorker: {
                        serviceWorkerVersion: serviceWorkerVersion,
                    }
                }).then(function(engineInitializer) {
                    clearTimeout(timeoutId);
                    return engineInitializer.initializeEngine();
                }).then(function(appRunner) {
                    return appRunner.runApp();
                }).then(function() {
                    var loadingElement = document.querySelector('#loading');
                    if (loadingElement) {
                        loadingElement.remove();
                    }
                }).catch(function(error) {
                    console.error('Error loading Flutter app:', error);
                    var loadingElement = document.querySelector('#loading');
                    if (loadingElement) {
                        loadingElement.innerHTML = 'Error loading app. Please refresh.';
                    }
                });
            });
        </script>
    </body>
</html>
